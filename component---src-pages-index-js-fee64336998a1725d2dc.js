(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{RXBc:function(e,t,a){"use strict";a.r(t);var n=a("q1tI"),r=a.n(n),o=a("Bl7J"),l=a("vrFN"),c=a("tRbT"),i=a("30+C"),u=a("oa/T"),s=a("ofer"),m=a("wb2y"),d=a("zkWZ"),f=a("MBC9"),v=a("toT+"),E=a("r/f7"),p=a("sYGQ"),h=a("1KIu"),b=a("Yjo7"),g=a("oz/O"),y=a("hkVh"),j=a("6LHu"),O=a("ysvj");t.default=function(){return r.a.createElement(v.a.Consumer,null,(function(e){var t=e.isSerialAvailable,a=e.connected,n=e.commandRobot,v=e.target,k=e.inputMethod,w=e.handleInputMethodChange,S=e.outputMethod,R=e.handleOutputMethodChange,x=e.settings,C=e.updateSettings;return r.a.createElement(o.a,null,r.a.createElement(l.a,{title:"Home"}),r.a.createElement(c.a,{container:!0,spacing:2,justify:"center"},r.a.createElement(c.a,{item:!0,xs:12,md:4,lg:3},r.a.createElement(i.a,null,r.a.createElement(u.a,null,r.a.createElement(s.a,null,"Input: ",!k&&"none selected"),r.a.createElement(d.a,{value:k,exclusive:!0,onChange:w},r.a.createElement(f.a,{value:"web"},"WEB"),r.a.createElement(f.a,{value:"remote",disabled:!0},"REMOTE")),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(s.a,null,"Output: ",!S&&"none selected"),r.a.createElement(d.a,{value:S,exclusive:!0,onChange:R},t&&r.a.createElement(f.a,{value:"serial"},"SERIAL"),r.a.createElement(f.a,{value:"visualizer"},"SR-VIS")),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(s.a,{variant:"caption"},"(more I/O coming soon)"),!t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement(s.a,null,"Could not detect serial capabilities. Please use the latest version of Chrome, open"," ",r.a.createElement("code",null,"chrome://flags"),", and set",r.a.createElement("code",null,"#enable-experimental-web-platform-features")," ","(note that these are experimental features, use at your own risk, etc etc)")))),r.a.createElement("hr",null),r.a.createElement(y.a,{target:v}),r.a.createElement("hr",null),r.a.createElement(E.a,{settings:x,updateSettings:C})),r.a.createElement(c.a,{item:!0,xs:12,md:4,lg:5},r.a.createElement(p.a,{connected:a,target:v,commandRobot:n}),r.a.createElement("hr",null),r.a.createElement(b.a,{connected:a,target:v,commandRobot:n})),r.a.createElement(c.a,{item:!0,xs:12,md:4,lg:4},r.a.createElement(h.a,{connected:a,commandRobot:n}),r.a.createElement("hr",null),r.a.createElement(j.a,{connected:a,target:v,commandRobot:n}),r.a.createElement("hr",null),r.a.createElement(O.a,{connected:a,target:v,commandRobot:n}),r.a.createElement("hr",null),r.a.createElement(g.a,{connected:a,target:v,commandRobot:n}))),"Â ",r.a.createElement(m.a,null))}))}},ysvj:function(e,t,a){"use strict";var n=a("8o2o"),r=a("q1tI"),o=a.n(r),l=a("30+C"),c=a("oa/T"),i=a("ofer"),u=a("cVXz"),s=a("jjAL"),m=a("Z3vd"),d=a("6Obz"),f=a("ZGBi"),v=a("UhlP"),E=a("o4QW"),p=a("xzpi"),h=a("rqAN");function b(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=e[Symbol.iterator]()).next.bind(a)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var y=function(e){var t=e.funscripts,a=e.axis,l=e.totalTime,c=e.vpos,i=Object(n.a)(e,["funscripts","axis","totalTime","vpos"]),u=Object(r.useRef)(null);Object(r.useEffect)((function(){!function(e){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#000000",e.beginPath(),e.moveTo(0,50);for(var n,r=b(t[a].actions);!(n=r()).done;){var o=n.value,c=o.at/l*2e4,i=100-o.pos;e.lineTo(c,i)}e.stroke()}(u.current.getContext("2d"))}),[t,a,l]),Object(r.useEffect)((function(){var e=Math.max(Math.floor(c/l*2e4)-400,0);document.getElementById("fiudfzdifu").scrollLeft=e}),[c,l]);var s={maxHeight:"120px",maxWidth:"800px",overflow:"scroll"};return o.a.createElement("div",{id:"fiudfzdifu",style:s},o.a.createElement("canvas",Object.assign({width:"20000px",height:"100px",ref:u},i)))};t.a=function(e){var t=e.connected,a=(e.target,e.commandRobot),n=Object(r.useState)(""),g=n[0],j=n[1],O=Object(r.useState)([]),k=O[0],w=O[1],S=Object(r.useState)(!1),R=S[0],x=S[1],C=Object(r.useState)(!0),A=C[0],L=C[1],T=Object(r.useState)(0),I=T[0],M=T[1],B=Object(r.useState)(0),V=B[0],z=B[1],P=Object(r.useState)(0),F=P[0],J=P[1],W=Object(r.useState)("100"),q=W[0],H=W[1],N=Object(r.useState)(0),U=N[0],Z=N[1],D=Object(r.useState)({}),G=D[0],Q=D[1],X=Object(r.useState)({}),Y=X[0],_=X[1],K=Object(r.useState)({}),$=K[0],ee=K[1],te=Object(r.useState)("none"),ae=te[0],ne=te[1],re=[["L0",".funscript"],["R2",".pitch.funscript"],["R1",".roll.funscript"],["R0",".twist.funscript"],["L1",".forward.funscript"]];Object(p.a)((function(){if(R){var e=document.getElementById("idvideo");if(e.paused)return;for(var n,r=1e3*e.currentTime-U,o=Object.assign({},G),l=Object.assign({},$),c=b(re.map((function(e){return e[0]})));!(n=c()).done;){var i=n.value;try{if(void 0===Y[i])continue;if(void 0===Y[i].actions)continue;var u=!!Y[i].inverted,s=Y[i].actions,m=$[i];s[m].at>r&&(m=0);for(var d=m+1;d<s.length&&s[d].at<r;)d++;if(d>=s.length||d<1)continue;if(s[m=d-1].at>r)continue;var f=s[m],v=s[d],E=10*Object(h.b)(f.pos,0,100),p=10*Object(h.b)(v.pos,0,100);u&&(E=1e3-E,p=1e3-p);var g=1*(r-f.at)/(v.at-f.at)*1,y=(1-g)*E+g*p;if("L0"===i&&A)if(y>850)I<=0?M(r):r-I>2e3&&(y=.8*Math.abs(1e3-(r-I-2e3)/4%2e3));else if(I<0){var j=Object(h.a)((r-Math.abs(I))/600,0,1);console.log("recovering "+j),y=j*y+(1-j)*o.L0,j>.95&&M(0)}else I>0&&(r-I>2e3?(M(-r),y=o.L0):M(0));o[i]=y,l[i]=m}catch(O){console.log(O)}}Q(o),ee(l),t&&a(o,0)}}),50);var oe=function(e){var t=e.key;e.target;if(!e.repeat){if(t>="1"&&t<="9"){var a=(t-"1")/8*100,n=Object.assign({},Y),r=1e3*document.getElementById("idvideo").currentTime-U;n[ae].actions.push({at:Math.floor(r),pos:Math.floor(a)}),n[ae].actions.sort((function(e,t){return e.at-t.at})),_(n),console.log("Axis "+ae+" has "+n[ae].actions.length+" actions")}if("0"===t){var o=Object.assign({},Y),l=document.getElementById("idvideo"),c=1e3*l.currentTime-U;o[ae].actions=o[ae].actions.filter((function(e){return e.at<c-1e3||e.at>c+500})),_(o),l.currentTime=c/1e3-3}}};Object(r.useEffect)((function(){return window.addEventListener("keydown",oe,!0),function(){return window.removeEventListener("keydown",oe,!0)}}));return Object(r.useEffect)((function(){k.length>0||fetch("video/videos.txt",{}).then((function(e){return e.text()})).then((function(e){w(e.split("\n"))}),(function(e){alert("Could not load list of video files")}))})),o.a.createElement(l.a,null,o.a.createElement(c.a,null,o.a.createElement(i.a,{variant:"h5"},"Video ",Math.floor(G.L0)," ",Math.floor(G.R2)," ",Math.floor(G.R1)),o.a.createElement("hr",null),o.a.createElement("video",{id:"idvideo",width:"100%",controls:!0}),"none"!==ae?o.a.createElement(y,{vpos:F,funscripts:Y,axis:ae,totalTime:V}):""),o.a.createElement(i.a,null,"File"),o.a.createElement(u.a,{id:"idselect",value:g,onChange:function(e,t){return function(e){var t={};document.getElementById("idvideo").src="video/"+e;for(var a,n="video/"+e.replaceAll(".mp4",""),r=[],o=function(){var e=a.value;r.push(fetch(n+e[1],{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(a){return a.json().then((function(a){return t[e[0]]=a})).catch((function(a){console.log(a),t[e[0]]=void 0}))})).catch((function(a){console.warn(a),t[e[0]]=void 0})))},l=b(re);!(a=l()).done;)o();Promise.allSettled(r).then((function(){ne("none"),j(e),_(t);var a={};for(var n in t)a[n]=0;for(var r in ee(a),a={},t)void 0!==t[r]&&(a[r]=500);Q(Object.assign({},a));var o=document.getElementById("idvideo");o.play(),o.ondurationchange=function(e){return z(1e3*e.srcElement.duration)},o.ontimeupdate=function(e){return J(1e3*e.srcElement.currentTime)}}))}(t.props.value)}},k.map((function(e){return o.a.createElement(s.a,{value:e,key:e},e)}))),o.a.createElement(u.a,{value:q,onChange:function(e,t){return a=t.props.value,document.getElementById("idvideo").playbackRate=parseFloat(a)/100,void H(a);var a}},o.a.createElement(s.a,{value:"10",key:"10"},"10%"),o.a.createElement(s.a,{value:"25",key:"25"},"25%"),o.a.createElement(s.a,{value:"50",key:"50"},"50%"),o.a.createElement(s.a,{value:"100",key:"100"},"100%")),o.a.createElement(u.a,{value:ae,onChange:function(e,t){return function(e){var t=Object.assign({},Y);if(void 0===t[e]){t[e]={actions:[{at:0,pos:50}]},_(t),console.log("created funscript file "+e);var a=Object.assign({},$);a[e]=0,ee(a)}ne(e)}(t.props.value)}},o.a.createElement(s.a,{value:"none",key:"none"},"none"),o.a.createElement(s.a,{value:"L0",key:"main"},"Main/L0"),o.a.createElement(s.a,{value:"R2",key:"pitch"},"Pitch/R2"),o.a.createElement(s.a,{value:"R1",key:"roll"},"Roll/R1"),o.a.createElement(s.a,{value:"R0",key:"twist"},"Twist/R0"),o.a.createElement(s.a,{value:"L1",key:"forward"},"Forward/L1"),o.a.createElement(s.a,{value:"L2",key:"left"},"Left/L2"),o.a.createElement(s.a,{value:"V0",key:"vibe1"},"Vibe1/V0"),o.a.createElement(s.a,{value:"A0",key:"valve"},"Valve/A0"),o.a.createElement(s.a,{value:"A1",key:"suck"},"Suck/A1")),o.a.createElement(m.a,{onClick:function(){return function(){var e=document.createElement("a");e.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(Y[ae])));for(var t,a=".json",n=b(re);!(t=n()).done;){var r=t.value;r[0]===ae&&(a=r[1])}e.setAttribute("download",g.replaceAll(".mp4",a)),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}()},variant:"contained",color:"default",disabled:"none"===ae},"Download script"),o.a.createElement(i.a,null,"Latency"),o.a.createElement(d.a,{value:U,min:-2e3,max:2e3,step:10,track:!1,valueLabelDisplay:"auto",onChange:function(e,t){return Z(t)},marks:[{value:-1e3,label:"Video 1s early"},{value:1e3,label:"Video 1s late"}]}),o.a.createElement(f.a,{key:"moving_pauses",label:"Moving pauses",control:o.a.createElement(v.a,{checked:A,onChange:function(e){return L(!A)},name:"Moving pauses",value:"moving_pauses",color:"primary"})}),o.a.createElement(E.a,null,o.a.createElement(m.a,{onClick:function(){return function(e){x(!e)}(R)},variant:"contained",color:"default"},R?"STOP":"START")))}}}]);
//# sourceMappingURL=component---src-pages-index-js-fee64336998a1725d2dc.js.map